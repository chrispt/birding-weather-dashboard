<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Weather forecast specifically tuned for birders - wind, visibility, pressure trends, and front passage timing">
    <meta name="theme-color" content="#2563eb">
    <title>Birding Weather Dashboard</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>

    <!-- App Styles -->
    <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
    <div class="app" id="app">
        <!-- Header -->
        <header class="header">
            <h1 class="header__title">Birding Weather Dashboard</h1>
            <div class="header__controls">
                <button class="btn btn--icon" id="theme-toggle" aria-label="Toggle night mode">
                    <span class="theme-icon">üåô</span>
                </button>
                <button class="btn btn--secondary" id="settings-btn">Settings</button>
            </div>
        </header>

        <!-- Location Bar -->
        <div class="location-bar">
            <div class="location-bar__info">
                <div class="location-bar__selector">
                    <span class="location-bar__name" id="location-name">Loading location...</span>
                    <button class="btn btn--icon location-bar__dropdown-btn" id="location-dropdown-btn" aria-label="Select location">
                        ‚ñº
                    </button>
                </div>
                <div class="location-dropdown hidden" id="location-dropdown">
                    <button class="location-dropdown__item location-dropdown__item--current" id="use-current-location">
                        üìç Use Current Location
                    </button>
                    <div class="location-dropdown__divider" id="recent-divider"></div>
                    <div class="location-dropdown__label" id="recent-label">Recent Locations</div>
                    <div id="recent-locations"></div>
                </div>
                <span class="location-bar__update" id="last-update"></span>
            </div>
            <div class="location-bar__actions">
                <span id="countdown"></span>
                <button class="btn btn--primary" id="refresh-btn">Refresh</button>
            </div>
        </div>

        <!-- Front Alert (hidden by default) -->
        <div class="alert alert--warning hidden" id="front-alert">
            <span class="alert__icon">‚ö†Ô∏è</span>
            <span class="alert__message" id="front-alert-message"></span>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard" id="dashboard">
            <!-- Current Conditions -->
            <div class="widget" id="current-widget">
                <div class="widget__header">
                    <span class="widget__title">Current Conditions</span>
                </div>
                <div class="widget__value" id="current-temp">--¬∞F</div>
                <div class="widget__subtitle" id="current-conditions">Loading...</div>
                <div class="widget__subtitle" id="current-humidity"></div>
            </div>

            <!-- Hawk Watch Score -->
            <div class="widget" id="hawk-widget">
                <div class="widget__header">
                    <span class="widget__title">Hawk Watch</span>
                </div>
                <div class="score" id="hawk-score">
                    <span class="score__value">--</span>
                    <span class="score__rating"></span>
                </div>
                <div class="widget__subtitle" id="hawk-details"></div>
            </div>

            <!-- Seabird Score -->
            <div class="widget" id="seabird-widget">
                <div class="widget__header">
                    <span class="widget__title">Seabird/Coastal</span>
                </div>
                <div class="score" id="seabird-score">
                    <span class="score__value">--</span>
                    <span class="score__rating"></span>
                </div>
                <div class="widget__subtitle" id="seabird-details"></div>
            </div>

            <!-- Wind Widget (full width) -->
            <div class="widget widget--full-width" id="wind-widget">
                <div class="widget__header">
                    <span class="widget__title">Wind</span>
                </div>
                <div style="display: flex; align-items: center; gap: 2rem;">
                    <div class="wind-rose" id="wind-rose">
                        <div class="wind-rose__arrow" id="wind-arrow"></div>
                        <div class="wind-rose__center"></div>
                    </div>
                    <div>
                        <div class="widget__value" id="wind-speed">-- mph</div>
                        <div class="widget__subtitle" id="wind-direction">Direction: --</div>
                        <div class="widget__subtitle" id="wind-gusts">Gusts: --</div>
                    </div>
                </div>
            </div>

            <!-- Visibility -->
            <div class="widget" id="visibility-widget">
                <div class="widget__header">
                    <span class="widget__title">Visibility</span>
                </div>
                <div class="widget__value" id="visibility-value">-- mi</div>
                <div class="widget__subtitle" id="visibility-fog"></div>
                <div class="widget__subtitle" id="fallout-risk"></div>
            </div>

            <!-- Precipitation -->
            <div class="widget" id="precip-widget">
                <div class="widget__header">
                    <span class="widget__title">Precipitation (Next 12h)</span>
                </div>
                <div class="precip-timeline" id="precip-timeline">
                    <!-- Filled by JS -->
                </div>
            </div>

            <!-- Pressure Trend -->
            <div class="widget" id="pressure-widget">
                <div class="widget__header">
                    <span class="widget__title">Pressure Trend</span>
                </div>
                <div class="widget__value" id="pressure-value">-- inHg</div>
                <div class="widget__subtitle" id="pressure-trend"></div>
                <div class="pressure-chart" id="pressure-chart">
                    <!-- Filled by JS -->
                </div>
            </div>

            <!-- Map (full width) -->
            <div class="widget widget--full-width" id="map-widget">
                <div class="widget__header">
                    <span class="widget__title">Nearby Hotspots</span>
                </div>
                <div class="map-container" id="map"></div>
            </div>
        </div>

        <!-- Hotspot Cards -->
        <div class="hotspots" id="hotspots">
            <!-- Filled by JS -->
        </div>

        <!-- Footer -->
        <footer class="footer">
            Weather data from <a href="https://open-meteo.com/" target="_blank" rel="noopener">Open-Meteo</a> |
            Hotspots from <a href="https://ebird.org/" target="_blank" rel="noopener">eBird</a> |
            Maps by <a href="https://leafletjs.com/" target="_blank" rel="noopener">Leaflet</a>
        </footer>
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settings-modal">
        <div class="modal">
            <div class="modal__header">
                <h2 class="modal__title">Settings</h2>
                <button class="modal__close" id="close-settings">&times;</button>
            </div>

            <div class="form-group">
                <label class="form-label" for="ebird-api-key">eBird API Key</label>
                <input type="text" class="form-input" id="ebird-api-key"
                       placeholder="Get a free key at ebird.org/api/keygen">
                <small style="color: var(--color-text-muted); font-size: 0.75rem;">
                    Required to show nearby hotspots
                </small>
            </div>

            <div class="form-group">
                <label class="form-label" for="temp-unit">Temperature Unit</label>
                <select class="form-input form-select" id="temp-unit">
                    <option value="F">Fahrenheit (¬∞F)</option>
                    <option value="C">Celsius (¬∞C)</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label" for="speed-unit">Wind Speed Unit</label>
                <select class="form-input form-select" id="speed-unit">
                    <option value="mph">Miles per hour (mph)</option>
                    <option value="kph">Kilometers per hour (kph)</option>
                </select>
            </div>

            <div class="form-group">
                <label class="form-label" for="pressure-unit">Pressure Unit</label>
                <select class="form-input form-select" id="pressure-unit">
                    <option value="inHg">Inches of Mercury (inHg)</option>
                    <option value="mb">Millibars (mb)</option>
                </select>
            </div>

            <button class="btn btn--primary" id="save-settings" style="width: 100%;">
                Save Settings
            </button>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <!-- App Script -->
    <script type="module" src="/src/main.js"></script>
</body>
</html>
